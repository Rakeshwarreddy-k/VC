"use strict";(self.webpackChunkvirtualclient=self.webpackChunkvirtualclient||[]).push([[2409],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>h});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},u=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(r),h=o,m=d["".concat(l,".").concat(h)]||d[h]||p[h]||i;return r?n.createElement(m,a(a({ref:t},u),{},{components:r})):n.createElement(m,a({ref:t},u))}));function h(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=r.length,a=new Array(i);a[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,a[1]=s;for(var c=2;c<i;c++)a[c]=r[c];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},2462:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var n=r(7462),o=(r(7294),r(3905));const i={},a="Network Workload Suite Profiles",s={unversionedId:"workloads/network/network-suite-profiles",id:"workloads/network/network-suite-profiles",title:"Network Workload Suite Profiles",description:"The following profiles run customer-representative or benchmarking scenarios using the Azure Networking benchmark",source:"@site/docs/workloads/network/network-suite-profiles.md",sourceDirName:"workloads/network",slug:"/workloads/network/network-suite-profiles",permalink:"/VirtualClient/docs/workloads/network/network-suite-profiles",draft:!1,editUrl:"https://github.com/microsoft/VirtualClient/edit/main/website/docs/workloads/network/network-suite-profiles.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Network Workload Suite Metrics",permalink:"/VirtualClient/docs/workloads/network/network-suite-metrics"},next:{title:"Network Workload Suite",permalink:"/VirtualClient/docs/workloads/network/network-suite"}},l={},c=[{value:"Preliminaries",id:"preliminaries",level:3},{value:"Topology Requirements (Client/Server)",id:"topology-requirements-clientserver",level:3},{value:"Client/Server Topologies",id:"clientserver-topologies",level:3},{value:"Resources",id:"resources",level:3}],u={toc:c};function p(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"network-workload-suite-profiles"},"Network Workload Suite Profiles"),(0,o.kt)("p",null,"The following profiles run customer-representative or benchmarking scenarios using the Azure Networking benchmark\nworkload suite."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/VirtualClient/docs/workloads/network/network-suite"},"Workload Details"),"  "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/VirtualClient/docs/workloads/network/network-suite-metrics"},"Workload Profile Metrics"),"  ")),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"preliminaries"},"Preliminaries"),(0,o.kt)("p",null,"The profiles below require the ability to download workload packages and dependencies from a package store. In order to download the workload packages, connection information\nmust be supplied on the command line. See the 'Workload Packages' documentation above for details on how that works."),(0,o.kt)("p",null,"Note that The virtual machines should have accelerated networking enabled. The systems will be configured for busy polling as well as for additional TCP ephemeral port options. The following settings\nare used to configure the systems. These settings were provided to the team by partner teams during the initial onboarding of the Networking workload and have been additionally confirmed by\nthe Azure Edge and Platform Network Performance team."),(0,o.kt)("admonition",{type:"danger"},(0,o.kt)("p",{parentName:"admonition"},"The systems are rebooted on first run after having these settings applied. The Virtual Client must be restarted to continue the execution of the Network workload. For testing purposes, this behaviors\ncan be disabled by supplying the 'ConfigureNetwork=false' parameter on the command line as noted in the examples below. For production operation, these system level settings should be applied.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"# On Windows systems\n# ------------------------------------------------------------------\nPowerShell.exe Set-NetTCPSetting -AutoReusePortRangeStartPort 10000 -AutoReusePortRangeNumberOfPorts 50000\"\n\n# On Linux systems\n# ------------------------------------------------------------------\n# 1) The following changes are made to the '/etc/security/limits.conf' file:\n*   soft    nofile  1048575\n*   hard    nofile  1048575\n\n# 2) The following changes are made to the '/etc/rc.local' file:\n#!/bin/sh\nsysctl -w net.ipv4.tcp_tw_reuse=1 # TIME_WAIT work-around\nsysctl -w net.ipv4.ip_local_port_range=\\\"10000 60000\\\"  # ephemeral ports increased\niptables -t raw -I OUTPUT -j NOTRACK  # disable connection tracking\niptables -t raw -I PREROUTING -j NOTRACK  # disable connection tracking\nsysctl -w net.core.busy_poll=50\nsysctl -w net.core.busy_read=50\n")),(0,o.kt)("h3",{id:"topology-requirements-clientserver"},"Topology Requirements (Client/Server)"),(0,o.kt)("p",null,"The Networking workload profiles ALL require a client/server topology in order to operate. This means that there must be 2 distinct systems in order\nto run the workload. One of the systems operates in the 'Client' role. The other system operates in the 'Server' role. The Virtual Client running on\nthe client and server systems will synchronize with each other before running each individual workload. An environment layout file MUST be supplied\nto each instance of the Virtual Client on the command line to describe the IP address/location of other Virtual Client instances. See the section below\non 'Client/Server Topologies'."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"../3-server-client/environment-layout.md"},"Environment Layouts")),(0,o.kt)("p",null,'In the environment layout file provided to the Virtual Client, define the role of the client system/VM as "Client" and the role of the server system/VM as "Server".\nThe spelling of the roles must be exact. The IP addresses of the systems/VMs must be correct as well. The following example illustrates the\nidea. The name of the client must match the name of the system or the value of the agent ID passed in on the command line.'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csharp"},"// Client role system\nVirtualClient.exe --profile=PERF-NETWORK.json --system=Azure --timeout=1440 --agentId=AnyVM01 --layoutPath=C:\\any\\path\\to\\layout.json\n\n// Server role system\nVirtualClient.exe --profile=PERF-NETWORK.json --system=Azure --timeout=1440 --agentId=AnyVM02 --layoutPath=C:\\any\\path\\to\\layout.json\n\n// Example contents of the 'layout.json' file below:\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "clients": [\n        {\n            "name": "AnyVM01",\n            "role": "Client",\n            "privateIPAddress": "10.1.0.1"\n        },\n        {\n            "name": "AnyVM02",\n            "role": "Server",\n            "privateIPAddress": "10.1.0.2"\n        }\n    ]\n}\n')),(0,o.kt)("h3",{id:"clientserver-topologies"},"Client/Server Topologies"),(0,o.kt)("p",null,"The Network suite of workloads are a client/server scenario whereby clients make TCP and UDP requests to a server host. As such this workload\nis only valid when ran in some form of client/server topology. The requirement is that there must be exactly 2 systems in order to create a proper\nclient/server interaction. In Azure Cloud environments, these 2 systems may be 2 virtual machines that run on the same physical node/blade. This scenario\nwill test performance that includes network performance aspects through a Hyper-V virtual switch. These 2 systems may also be 2 virtual machines that\nrun on different physical nodes/blades. This scenario will test performance through the physical network of a data center rack or cluster. Data center\nracks have a top-of-rack network/T1 switch (TOR). Data center racks are connected by T2 network switches. The default production scenario targets the\nphysical network systems and typically SameCluster/T2 network switches."),(0,o.kt)("p",null,"The Virtual Client itself does not create these topologies or the virtual machines etc... within them. This is a feature expected of the user or\nthe automation running the Virtual Client application. Once the environment is setup, it is easy to provide topology/layout information to the Virtual Client so that each\ninstance running on a given system knows about all of the other instances and additionally knows what its role to play in the client/server workload\nexecution process is."),(0,o.kt)("p",null,"See ",(0,o.kt)("a",{parentName:"p",href:"../3-server-client/environment-layout.md"},"Environment Layouts")," for more information."),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"resources"},"Resources"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/virtual-machines/sizes"},"Azure VM Sizes")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://azure.microsoft.com/en-us/pricing/details/managed-disks/"},"Azure Managed Disks"))))}p.isMDXComponent=!0}}]);