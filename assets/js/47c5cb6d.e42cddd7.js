"use strict";(self.webpackChunkvirtualclient=self.webpackChunkvirtualclient||[]).push([[3186],{3905:(e,n,i)=>{i.d(n,{Zo:()=>u,kt:()=>m});var r=i(7294);function t(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function o(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,r)}return i}function a(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?o(Object(i),!0).forEach((function(n){t(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function l(e,n){if(null==e)return{};var i,r,t=function(e,n){if(null==e)return{};var i,r,t={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],n.indexOf(i)>=0||(t[i]=e[i]);return t}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)i=o[r],n.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(t[i]=e[i])}return t}var s=r.createContext({}),c=function(e){var n=r.useContext(s),i=n;return e&&(i="function"==typeof e?e(n):a(a({},n),e)),i},u=function(e){var n=c(e.components);return r.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},p=r.forwardRef((function(e,n){var i=e.components,t=e.mdxType,o=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=c(i),m=t,f=p["".concat(s,".").concat(m)]||p[m]||d[m]||o;return i?r.createElement(f,a(a({ref:n},u),{},{components:i})):r.createElement(f,a({ref:n},u))}));function m(e,n){var i=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var o=i.length,a=new Array(o);a[0]=p;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:t,a[1]=l;for(var c=2;c<o;c++)a[c]=i[c];return r.createElement.apply(null,a)}return r.createElement.apply(null,i)}p.displayName="MDXCreateElement"},1344:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>s,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var r=i(7462),t=(i(7294),i(3905));const o={id:"understand-profile",sidebar_position:4},a="Understand VC components and profiles",l={unversionedId:"guides/understand-profile",id:"guides/understand-profile",title:"Understand VC components and profiles",description:"Scenario: Overriding Parameters in a Workload Profile",source:"@site/docs/guides/4-understand-profile.md",sourceDirName:"guides",slug:"/guides/understand-profile",permalink:"/VirtualClient/docs/guides/understand-profile",draft:!1,editUrl:"https://github.com/microsoft/VirtualClient/edit/main/docs/guides/4-understand-profile.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{id:"understand-profile",sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Environment Layouts",permalink:"/VirtualClient/docs/guides/server-client/EnvironmentLayouts"},next:{title:"Supported Workloads and Monitors",permalink:"/VirtualClient/docs/guides/supported-workloads"}},s={},c=[{value:"Scenario: Overriding Parameters in a Workload Profile",id:"scenario-overriding-parameters-in-a-workload-profile",level:3},{value:"Scenario: Running Specific Scenarios in a Workload Profile",id:"scenario-running-specific-scenarios-in-a-workload-profile",level:3},{value:"Scenario: Excluding Specific Scenarios in a Workload Profile",id:"scenario-excluding-specific-scenarios-in-a-workload-profile",level:3},{value:"Scenario: Running a Custom Profile on the File System",id:"scenario-running-a-custom-profile-on-the-file-system",level:3},{value:"Scenario: Running a Custom Profile Downloaded from a URI",id:"scenario-running-a-custom-profile-downloaded-from-a-uri",level:3},{value:"Scenario: Running a Custom Monitoring Profile",id:"scenario-running-a-custom-monitoring-profile",level:3}],u={toc:c};function d(e){let{components:n,...i}=e;return(0,t.kt)("wrapper",(0,r.Z)({},u,i,{components:n,mdxType:"MDXLayout"}),(0,t.kt)("h1",{id:"understand-vc-components-and-profiles"},"Understand VC components and profiles"),(0,t.kt)("h3",{id:"scenario-overriding-parameters-in-a-workload-profile"},"Scenario: Overriding Parameters in a Workload Profile"),(0,t.kt)("p",null,"Each profile definition available in the Virtual Client can have parameters that are overridable. In general, scenario profiles are defined to such that certain aspects of\nrunning the workload are set in stone if you will. Workload profiles are designed with certain amounts of expertise and empirical evidence in mind. However, there are sometimes\na small set of reasonable variations that make sense for flexibility."),(0,t.kt)("p",null,"Note that you can determine which parameters can be overridden on the command line in a workload profile by looking at the profile definition itself. Any parameters that\nare in the 'Parameters' section at the top of a profile definition can be overridden. The documentation for each of the profiles also provides these details. See the following\nprofile definitions for examples."),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"https://github.com/microsoft/VirtualClient/blob/main/src/VirtualClient/VirtualClient.Main/profiles/PERF-IO-FIO.json&version=GBmaster"},"FIO Workload Profile"))),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'VirtualClient.exe --profile=PERF-IO-FIO.json --timeout=180 --packages="{BlobStoreConnectionString|SAS URI}" --parameters="DiskFilter=OSDisk:false&biggestSize"\n')),(0,t.kt)("hr",null),(0,t.kt)("h3",{id:"scenario-running-specific-scenarios-in-a-workload-profile"},"Scenario: Running Specific Scenarios in a Workload Profile"),(0,t.kt)("p",null,"Certain profiles available for the Virtual Client have more than one action/scenario that is executed. These profiles are designed to test\nthe system in various ways to produce robust performance evaluations. The Virtual Client supports the ability to specify a specific\nset of scenarios within the profile. This is useful for cases where certain scenarios show unexpected performance outcomes and the user\nwould like to run those specific scenarios again (vs. the entire profile). See the following profile for examples of scenario definitions within\nthe profile:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"https://github.com/microsoft/VirtualClient/blob/main/src/VirtualClient/VirtualClient.Main/profiles/PERF-IO-FIO.json"},"PERF-IO-FIO.json"))),(0,t.kt)("p",null,"Each action/step defined in a profile can have a 'Scenario' parameter:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "Type": "FioExecutor",\n    "Parameters": {\n        "Scenario": "DiskFill",\n        "CommandLine": "--name=disk_fill --size=[filesize] --numjobs=1 --rw=write --bs=256k --iodepth=64 --direct=1 --overwrite=1 --thread",\n        ...\n    }\n},\n{\n    "Type": "FioExecutor",\n    "Parameters": {\n        "Scenario": "RandomWrite_4k_BlockSize",\n        "CommandLine": "--name=fio_randwrite_[filesize]_4k_d[queuedepth]_th[threads] --size=[filesize] --numjobs=[threads] --rw=randwrite --bs=4k --iodepth=[queuedepth] --direct=1 --ramp_time=30 --runtime=300 --time_based --overwrite=1 --thread --group_reporting --output-format=json",\n        ...\n    }\n},\n{\n    "Type": "FioExecutor",\n    "Parameters": {\n        "Scenario": "RandomWrite_8k_BlockSize",\n        "CommandLine": "--name=fio_randwrite_[filesize]_4k_d[queuedepth]_th[threads] --size=[filesize] --numjobs=[threads] --rw=randwrite --bs=4k --iodepth=[queuedepth] --direct=1 --ramp_time=30 --runtime=300 --time_based --overwrite=1 --thread --group_reporting --output-format=json",\n        ...\n    }\n},\n{\n    "Type": "FioExecutor",\n    "Parameters": {\n        "Scenario": "RandomWrite_12k_BlockSize",\n        "CommandLine": "--name=fio_randwrite_[filesize]_4k_d[queuedepth]_th[threads] --size=[filesize] --numjobs=[threads] --rw=randwrite --bs=4k --iodepth=[queuedepth] --direct=1 --ramp_time=30 --runtime=300 --time_based --overwrite=1 --thread --group_reporting --output-format=json",\n        ...\n    }\n}\n')),(0,t.kt)("p",null,"To include multiple scenarios, supply a set of scenario names on the command line delimited by a comma or semi-colon as is illustrated below."),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'# Run the DiskFill, RandomWrite_4k_BlockSize and RandomWrite_8k_BlockSize scenarios only\nVirtualClient.exe --profile=PERF-IO-FIO.json --timeout=180 --packages="{BlobStoreConnectionString|SAS URI}" --scenarios=DiskFill,RandomWrite_4k_BlockSize,RandomWrite_8k_BlockSize\n')),(0,t.kt)("hr",null),(0,t.kt)("h3",{id:"scenario-excluding-specific-scenarios-in-a-workload-profile"},"Scenario: Excluding Specific Scenarios in a Workload Profile"),(0,t.kt)("p",null,"Similarly to the above example where specific scenarios are specified, specific scenarios can be excluded as well. This is useful for cases where the user wants to run most components in\na profile except for a few."),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"https://github.com/microsoft/VirtualClient/blob/main/src/VirtualClient/VirtualClient.Main/profiles/PERF-IO-FIO.json"},"PERF-IO-FIO.json"))),(0,t.kt)("p",null,"Each action/step defined in a profile can have a 'Scenario' parameter:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "Type": "FioExecutor",\n    "Parameters": {\n        "Scenario": "DiskFill",\n        "CommandLine": "--name=disk_fill --size=[filesize] --numjobs=1 --rw=write --bs=256k --iodepth=64 --direct=1 --overwrite=1 --thread",\n        ...\n    }\n},\n{\n    "Type": "FioExecutor",\n    "Parameters": {\n        "Scenario": "RandomWrite_4k_BlockSize",\n        "CommandLine": "--name=fio_randwrite_[filesize]_4k_d[queuedepth]_th[threads] --size=[filesize] --numjobs=[threads] --rw=randwrite --bs=4k --iodepth=[queuedepth] --direct=1 --ramp_time=30 --runtime=300 --time_based --overwrite=1 --thread --group_reporting --output-format=json",\n        ...\n    }\n},\n{\n    "Type": "FioExecutor",\n    "Parameters": {\n        "Scenario": "RandomWrite_8k_BlockSize",\n        "CommandLine": "--name=fio_randwrite_[filesize]_4k_d[queuedepth]_th[threads] --size=[filesize] --numjobs=[threads] --rw=randwrite --bs=4k --iodepth=[queuedepth] --direct=1 --ramp_time=30 --runtime=300 --time_based --overwrite=1 --thread --group_reporting --output-format=json",\n        ...\n    }\n},\n{\n    "Type": "FioExecutor",\n    "Parameters": {\n        "Scenario": "RandomWrite_12k_BlockSize",\n        "CommandLine": "--name=fio_randwrite_[filesize]_4k_d[queuedepth]_th[threads] --size=[filesize] --numjobs=[threads] --rw=randwrite --bs=4k --iodepth=[queuedepth] --direct=1 --ramp_time=30 --runtime=300 --time_based --overwrite=1 --thread --group_reporting --output-format=json",\n        ...\n    }\n}\n')),(0,t.kt)("p",null,"To exclude scenarios, supply a set of scenario names on the command line delimited by a comma or semi-colon to exclude as is illustrated below. These scenario names should have a minus (-) sign in\nfront of the name (e.g. -RandomWrite_8k_BlockSize). Note that in the case where there are scenarios included as well as excluded having the same name, included scenarios take priority\n(e.g. --scenarios=scenario1,-scenario1 -> scenario1 will be included)."),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'# Exclude the RandomWrite_4k_BlockSize and RandomWrite_8k_BlockSize scenarios. Run everything else.\nVirtualClient.exe --profile=PERF-IO-FIO.json --timeout=03:00:00 --packages="{BlobStoreConnectionString|SAS URI}" --scenarios=-RandomWrite_4k_BlockSize,-RandomWrite_8k_BlockSize\n')),(0,t.kt)("h3",{id:"scenario-running-a-custom-profile-on-the-file-system"},"Scenario: Running a Custom Profile on the File System"),(0,t.kt)("p",null,"Virtual Client can run profiles that are not necessarily part of the original release package. For example, a user can create a custom profile and place it in a folder that is not in the Virtual Client application\nfolder itself. This is very helpful for debugging scenarios (see the section at the bottom of the ",(0,t.kt)("a",{parentName:"p",href:"../DEVELOPER_GUIDE.md"},"Developer Guide")," for examples). The one requirement for this scenario is that the actions, monitors or\ndependencies in the custom profile must be known to the version of the Virtual Client runtime executable being used to run the profile."),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'# Run a custom profile from somewhere else on the file system.\n# On Windows\nVirtualClient.exe --profile=S:\\source\\debugging\\CUSTOM-PROFILE.json --timeout=180 --packages="{BlobStoreConnectionString|SAS URI}"\n\n# On Linux\n./VirtualClient --profile=/home/user/source/debugging/CUSTOM-PROFILE.json --timeout=03:00:00 --packages="{BlobStoreConnectionString|SAS URI}"\n')),(0,t.kt)("hr",null),(0,t.kt)("h3",{id:"scenario-running-a-custom-profile-downloaded-from-a-uri"},"Scenario: Running a Custom Profile Downloaded from a URI"),(0,t.kt)("p",null,'Virtual Client can run profiles that are downloaded from a URI. For example, a user can create a custom profile and upload it to an Azure storage account. This is very helpful for enabling quick support for new variations\nof a profile without needing to recompile the Virtual Client application. One requirement for this scenario is that the actions, monitors or dependencies in the custom profile must be known to the version of the\nVirtual Client runtime executable being used to run the profile. The second requirement is that the profile resource at the URI location must allow for anonymous access. Virtual Client does not supply any credentials\nto the target endpoint. For example in an Azure storage account, a blob container can be created with "Blob Anonymous Read" access. This access allows a user to download the profile/blob but he/she cannot scan the container\nor modify the blob.'),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'# Run a custom profile downloaded from a URI location.\nVirtualClient.exe --profile=https://any.blob.core.windows.net/profiles/CUSTOM-PROFILE.json --timeout=180 --packages="{BlobStoreConnectionString|SAS URI}"\n')),(0,t.kt)("hr",null),(0,t.kt)("h3",{id:"scenario-running-a-custom-monitoring-profile"},"Scenario: Running a Custom Monitoring Profile"),(0,t.kt)("p",null,"There are cases where the user wants to run a specific set of monitors behind the scenes while workloads are running. The Virtual Client application allows\nthe user to define a specific monitoring profile on the command line in conjunction with the workload profile."),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'VirtualClient.exe --profile=PERF-NETWORK.json --timeout=180 --packages="{BlobStoreConnectionString|SAS URI}" --parameters="ProfilingEnabled=true,,,ProfilingMode=Interval"\n')),(0,t.kt)("hr",null))}d.isMDXComponent=!0}}]);