<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-developing/0060-develop-workload">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Workload Development Recommendations | Virtual Client</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://microsoft.github.io/VirtualClient/docs/developing/0060-develop-workload/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="performance, benchmarking, automation, framework, microsoft"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Workload Development Recommendations | Virtual Client"><meta data-rh="true" name="description" content="The following documentation provides guidance on the practices and fundamentals that the CRC team recommends for teams who want to create workloads to"><meta data-rh="true" property="og:description" content="The following documentation provides guidance on the practices and fundamentals that the CRC team recommends for teams who want to create workloads to"><link data-rh="true" rel="icon" href="/VirtualClient/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://microsoft.github.io/VirtualClient/docs/developing/0060-develop-workload/"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/VirtualClient/docs/developing/0060-develop-workload/" hreflang="en"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/VirtualClient/docs/developing/0060-develop-workload/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://0I7D8A07MA-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/VirtualClient/blog/rss.xml" title="Virtual Client RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/VirtualClient/blog/atom.xml" title="Virtual Client Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Virtual Client" href="/VirtualClient/opensearch.xml"><link rel="stylesheet" href="/VirtualClient/assets/css/styles.9440764c.css">
<link rel="preload" href="/VirtualClient/assets/js/runtime~main.ae9c38a3.js" as="script">
<link rel="preload" href="/VirtualClient/assets/js/main.0a41c4c4.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like VirtualClient, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/microsoft/VirtualClient">GitHub</a> ⭐️</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/VirtualClient/"><div class="navbar__logo"><img src="/VirtualClient/img/vc-logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/VirtualClient/img/vc-logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Virtual Client</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/VirtualClient/docs/overview/">Documentation</a><a class="navbar__item navbar__link" href="/VirtualClient/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/microsoft/VirtualClient" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/VirtualClient/docs/category/overview/">Overview</a><button aria-label="Toggle the collapsible sidebar category &#x27;Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/VirtualClient/docs/category/guides/">Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/VirtualClient/docs/category/workloads/">Workloads</a><button aria-label="Toggle the collapsible sidebar category &#x27;Workloads&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/VirtualClient/docs/category/monitors/">Monitors</a><button aria-label="Toggle the collapsible sidebar category &#x27;Monitors&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/VirtualClient/docs/category/dependencies/">Dependencies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Dependencies&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/VirtualClient/docs/category/developing/">Developing</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developing&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0001-ci-cd/">Automated Build and CI/CD pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0010-develop-guide/">Developer Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0020-develop-extensions/">Developing Extensions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0030-workload-onboarding/">Workload Onboarding Process</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0040-vc-packages/">VC Packages</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0050-develop-profiling-monitor/">Profiler Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/VirtualClient/docs/developing/0060-develop-workload/">Workload Development Recommendations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0061-build-docker-container/">Building Docker Containers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0070-error-handling/">Error Handling Recommendations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0080-coding-standards/">Coding Standards</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/VirtualClient/docs/developing/0090-testing/">Testing Practices</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/VirtualClient/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/VirtualClient/docs/category/developing/"><span itemprop="name">Developing</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Workload Development Recommendations</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Workload Development Recommendations</h1><p>The following documentation provides guidance on the practices and fundamentals that the CRC team recommends for teams who want to create workloads to
run as part of CRC Flighting system experiments. The overarching goal of these recommendations is to create a recipe for the creation of workloads that
can be easily developed and easily integrated into the CRC Flighting system via the Virtual Client workload provider.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="terminology">Terminology<a href="#terminology" class="hash-link" aria-label="Direct link to Terminology" title="Direct link to Terminology">​</a></h2><p>The following pieces of terminology are used often to describe CRC Flighting system experiments and workloads.</p><ul><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="workload">Workload<a href="#workload" class="hash-link" aria-label="Direct link to Workload" title="Direct link to Workload">​</a></h4><p>These are special agents/toolsets/software that CRC runs on blades or VMs as part of a flighting experiment that were designed to represent the experience of a
customer. The CRC team runs workloads to capture various reliability and performance metrics from the system while a payload/change is being applied to
the physical node/system underneath. These metrics, when compiled in large datasets, allow the CRC team to accurately analyze the real net impact of a
given change on the overall customer experience. </p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="crc-flighting-system">CRC Flighting System<a href="#crc-flighting-system" class="hash-link" aria-label="Direct link to CRC Flighting System" title="Direct link to CRC Flighting System">​</a></h4><p>The execution system that provides the automation to conduct firmware/hardware A/B experiments at-scale in the production Azure fleet.</p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="virtual-client">Virtual Client<a href="#virtual-client" class="hash-link" aria-label="Direct link to Virtual Client" title="Direct link to Virtual Client">​</a></h4><p>The Virtual Client is the customer-representative workload provider for the CRC Flighting system. It is an executable that abstracts the complexities of
running workloads from the flighting execution system providing the integration point for new customer/partner workloads that will be ran in
the flighting system. The Virtual Client additionally ensures standardization in capturing system performance information as well as telemetry that
is emitted as part of workloads running in CRC experiments.</p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="addressable-fleet">Addressable Fleet<a href="#addressable-fleet" class="hash-link" aria-label="Direct link to Addressable Fleet" title="Direct link to Addressable Fleet">​</a></h4><p>The CRC team focuses on the addressable Azure fleet. Fleet nodes that are addressable exist in clusters that are fully online for use by either
internal Azure teams or public customers. Clusters are qualified as online when all of the cluster fabric services are enabled including the TiP
service. The cluster fabric services are required to be enabled in order to properly manage nodes within the cluster including the ability for
users/customers to request cloud resources via ARM (Azure Resource Manager).</p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="compute-nodes">Compute Nodes<a href="#compute-nodes" class="hash-link" aria-label="Direct link to Compute Nodes" title="Direct link to Compute Nodes">​</a></h4><p>Compute nodes are designed to host VMs as a general rule. Many of the Azure services that run in the cloud and that we offer customers rely on VMs
in whole or in part to host the software that implements the services being provided. CRC largely focuses on compute nodes because they are the nodes
directly used by customers and that have the most direct impact on their experience. </p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="utility-nodes">Utility Nodes<a href="#utility-nodes" class="hash-link" aria-label="Direct link to Utility Nodes" title="Direct link to Utility Nodes">​</a></h4><p>Utility nodes are designed primarily to host cluster fabric services use to manage the cluster itself. They do not host customer services or workloads.
The CRC team does not currently focus on utility nodes. However, the team is actively working to extend fleet coverage targets to include utility nodes
within the Cobalt semester. </p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="storage-nodes">Storage Nodes<a href="#storage-nodes" class="hash-link" aria-label="Direct link to Storage Nodes" title="Direct link to Storage Nodes">​</a></h4><p>Storage nodes are designed primarily to integrate with large arrays of physical disks (JBODs). They do not host customer services or workloads. Compute
nodes often use storage nodes to provide for customer storage necessities (e.g. storage of the VHD file). Storage nodes are not supported by either the
TiP service nor the ARM service and often run a different OS than compute nodes. Because of these distinctions, CRC cannot currently target storage nodes
for flighting validations. With that said, there are opportunities here in partnership with the TiP service team where validations on storage nodes would
be made possible. In the semesters that follow Cobalt, CRC may amend the current coverage strategy to perform some amount of validations on these SKUs
where it is deemed critical to the business. </p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="general-purpose-sku">General Purpose SKU<a href="#general-purpose-sku" class="hash-link" aria-label="Direct link to General Purpose SKU" title="Direct link to General Purpose SKU">​</a></h4><p>A general purpose SKU represents nodes that are used by customers for everyday compute needs. The vast majority of the Azure fleet are general purpose
hardware SKUs. </p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="special-purpose-sku">Special Purpose SKU<a href="#special-purpose-sku" class="hash-link" aria-label="Direct link to Special Purpose SKU" title="Direct link to Special Purpose SKU">​</a></h4><p>Special SKUs are nodes that have hardware components used to enable special computational capabilities for customers. These SKUs for example might have
multiple CPU sockets and many cores for high performance computing needs or GPU chips that are specially designed for advanced graphics rendering/gaming
capabilities. These SKUs make up a small percentage of the fleet; however, the customers using them pay a lot of money for these capabilities and an
interruption to the service on these SKUs typically causes a very substantial impact to the customer. Common special SKU categories include GPC, GPM, GPZ,
HM, HPC, VHM, DWS, and FPG. </p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="payload">Payload<a href="#payload" class="hash-link" aria-label="Direct link to Payload" title="Direct link to Payload">​</a></h4><p>A payload is a change that is made to a physical node/system. For example, the deployment of a microcode firmware update is a change to nodes in the
fleet. In practice, payloads represent updates to the physical infrastructure of the Azure fleet that are often associated with required SLA guarantees
we offer Azure customers. They are deployed to systems while they are running and thus carry a significant risk to the interruption of service for Azure
customers. Historically, these changes have been associated with increases in annual interrupt rates (AIR) for Azure customers and are thus the fundamental subject of CRC validations. </p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="goals-for-creating-a-good-workload">Goals for Creating a Good Workload<a href="#goals-for-creating-a-good-workload" class="hash-link" aria-label="Direct link to Goals for Creating a Good Workload" title="Direct link to Goals for Creating a Good Workload">​</a></h2><p>The following sections describes some of the goals involved in the creation of a good workload. At a high-level, a good workload:</p><ul><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="runs-consistently-reliable-tests">Runs Consistently Reliable Tests<a href="#runs-consistently-reliable-tests" class="hash-link" aria-label="Direct link to Runs Consistently Reliable Tests" title="Direct link to Runs Consistently Reliable Tests">​</a></h4><p>The test that the workload runs should be consistently reliable. If the test itself cannot consistently produce results time and time again then
it produces too much variation (noise) for it to be used to accurately gauge the state of a system under test. This is about code quality and defensive
programming in many ways.</p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="runs-consistently-repeatable-tests">Runs Consistently Repeatable Tests<a href="#runs-consistently-repeatable-tests" class="hash-link" aria-label="Direct link to Runs Consistently Repeatable Tests" title="Direct link to Runs Consistently Repeatable Tests">​</a></h4><p>The tests that the workload runs should be repeatable in the characteristics of the results. This means that the same test ran on the same node/VM
over and over should produce similar results given nothing has changed on the system under test. This is not to say that the results will be identical
but that the standard deviation of the results would be generally small given all other things being equal on the system.</p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="produces-objective-results">Produces Objective Results<a href="#produces-objective-results" class="hash-link" aria-label="Direct link to Produces Objective Results" title="Direct link to Produces Objective Results">​</a></h4><p>The tests that the workload runs should produce definitive and objective results. The results should not make estimations as a general rule but should
instead attempt to measure facets of the system that are based on hardened and vetted patterns, practices and software. For example, on a Windows system
the performance counter and ETW sub-systems are highly refined and reliable. A workload can confidently rely upon performance counters to measure many performance
characteristics of the system in a precise manner.</p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="produces-structured-results">Produces Structured Results<a href="#produces-structured-results" class="hash-link" aria-label="Direct link to Produces Structured Results" title="Direct link to Produces Structured Results">​</a></h4><p>The results that a good workload produces, will be in a consistently structured format. This makes it easy for the results to be parsed for meaningful
insights and aggregations.</p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="is-easy-to-integrate-with-other-systems">Is Easy to Integrate with Other Systems<a href="#is-easy-to-integrate-with-other-systems" class="hash-link" aria-label="Direct link to Is Easy to Integrate with Other Systems" title="Direct link to Is Easy to Integrate with Other Systems">​</a></h4><p>A good workload should be easy to use thus making it easy to integrate into the larger execution system. This reduces the overhead required for
teams to onboard new and valueable test scenarios.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="workload-recipe">Workload Recipe<a href="#workload-recipe" class="hash-link" aria-label="Direct link to Workload Recipe" title="Direct link to Workload Recipe">​</a></h2><p>Given the goals noted above, the following section provides a general recipe that can be followed when creating a workload for easy integrated into
the CRC Flighting system. Provided the recipe is followed, it is typically very quick for the CRC team to onboard new workload scenarios which
can then produce valuable results at-scale in A/B experiments.</p><ul><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-workload-as-a-simple-command-line-tool">Create the workload as a simple command-line tool<a href="#create-the-workload-as-a-simple-command-line-tool" class="hash-link" aria-label="Direct link to Create the workload as a simple command-line tool" title="Direct link to Create the workload as a simple command-line tool">​</a></h4><ul><li><p>[Option 1]<!-- -->: Create a command line executable. </p><ul><li>All platforms support executables and there is a lot of of pre-existing OS/systems integration support.</li><li>Command line executables can typically be compiled to support multiple OS platforms (Windows vs. Linux) as well as CPU architectures.</li><li>Command line executables are easy to port around (e.g. copy, download etc...).</li><li>This is the preferred option.<br><br></li></ul></li><li><p>[Option 2]<!-- -->: Create the workload as a PowerShell Core/7 script or module.</p><ul><li>PowerShell Core/7 is an industrial strength scripting language that can run on both Windows and Linux operating systems.</li><li>PowerShell has support for multiple CPU architectures.</li><li>PowerShell scripts and modules are easy to port around (e.g. copy, download etc...).<br><br></li></ul></li><li><p>Workloads that require GUI support should be avoided.</p><ul><li>They are not easy to integrate into automation workflows and may not even run in certain server OS environments.<br><br></li></ul></li><li><p>Driver-like workloads<br>
<!-- -->For certain workloads that need to run at the Kernel level, it may not be possible to have a traditional executable script to execute the test
logic. For these scenarios, it is important that the driver/workload utilize well-known/vetted sub-systems (e.g. performance counters, ETW) in order
to produce results. The more challenging aspect of these type of workloads is the deployment requirements.</p></li></ul></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-workload-should-be-written-in-a-cross-platform-programmingscripting-language">The workload should be written in a cross-platform programming/scripting language<a href="#the-workload-should-be-written-in-a-cross-platform-programmingscripting-language" class="hash-link" aria-label="Direct link to The workload should be written in a cross-platform programming/scripting language" title="Direct link to The workload should be written in a cross-platform programming/scripting language">​</a></h4><p>Whereas it is not always a requirement for certain scenarios, the CRC Flighting system tests on both Windows and Linux systems. A good workload can run
on either of these systems. Indeed a large portion of the VMs used by Azure customers are Linux VMs.</p><ul><li><p>[Option 1]<!-- -->: Write the workload application in native programming language such as C++.  </p><ul><li>Native code applications can be compiled to target multiple OS platforms and CPU architectures.</li><li>Native code applications can be signed as part of Azure Official builds so that they can be run on the Azure physical host itself.</li><li>The Virtual Client already runs native code executables so there is a precedent in place.</li><li>This is a preferred option.<br><br></li></ul></li><li><p>[Option 2]<!-- -->: Write the workload application in .NET Core/5.0.  </p><ul><li>The .NET Core/5.0 framework enables applications to be written in a managed coding language such as C# that can be compiled to run on multiple OS
platforms and CPU architectures.</li><li>.NET Core/5.0 applications can typically be developed at speed significantly faster than with native programming languages.</li><li>.NET Core/5.0 applications can be signed as part of Azure Official builds so that they can be run on the Azure physical host itself.</li><li>Many team members in Azure are proficient in managed coding skillsets and thus can contribute to ongoing development needs.</li><li>The CRC Flighting system and the Virtual Client itself are primarily written in .NET Core/5.0/C# and runs on both VMs (Windows and Linux) as well as Azure hosts (including ARM64 hosts).</li><li>The Virtual Client already runs managed code executables so there is a precedent in place.</li><li>This is a preferred option.<br><br></li></ul></li><li><p>[Option 3]<!-- -->: Write the workload application in PowerShell Core/7.  </p><ul><li>PowerShell Core/7 scripts and modules can run on both Windows and Linux systems.</li><li>PowersShell Core/7 scripts and modules can be signed as part of Azure Official builds so that they can be run on the Azure physical host itself.</li><li>The Virtual Client already runs workloads that have bootstrapping/setup needs that are handled with PowerShell scripts so there is a precedent in place.<br><br></li></ul></li><li><p>[Option 4]<!-- -->: Write the workload application in Python.</p><ul><li>Python has a portal execution interpreter/runtime that provides support for both Windows and Linux systems.</li><li>There may be restrictions that prevent running Python on Azure physical hosts.</li></ul></li></ul></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-workload-should-be-parameterized">The workload should be parameterized<a href="#the-workload-should-be-parameterized" class="hash-link" aria-label="Direct link to The workload should be parameterized" title="Direct link to The workload should be parameterized">​</a></h4><p>In order to ensure that the workload can support all necessary scenarios and configuration requirements, the workload should allow all important
settings to be provided on the command line.</p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-workload-should-be-designed-to-produce-a-consistent-steady-state-test">The workload should be designed to produce a consistent steady-state test<a href="#the-workload-should-be-designed-to-produce-a-consistent-steady-state-test" class="hash-link" aria-label="Direct link to The workload should be designed to produce a consistent steady-state test" title="Direct link to The workload should be designed to produce a consistent steady-state test">​</a></h4><p>As mentioned in the goals above, the workload should produce consistent and reliable results. The best workloads run a &quot;steady-state&quot; test. A steady state
test will run the exact same execution workflow each time given the same settings are provided. The tests should not be based on algorithms that cannot produce
a steady state time and time again. Tests should also avoid testing aspects of the system that are themselves highly variable. Highly variable algorithms or aspects
will inevitably produce highly variable results. These results will make it difficult to ascertain differences in the system performance when changes
are made to the system under test.</p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-workload-should-run-the-exact-same-test-every-time-given-exact-settings">The workload should run the exact same test every time given exact settings<a href="#the-workload-should-run-the-exact-same-test-every-time-given-exact-settings" class="hash-link" aria-label="Direct link to The workload should run the exact same test every time given exact settings" title="Direct link to The workload should run the exact same test every time given exact settings">​</a></h4><p>Following up on the bullet point above, a workload should run the exact same test every time given a set of specific settings. The tests ran should
vary only when the settings supplied on the command line have changed.</p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-workload-should-produce-highly-structured-results">The workload should produce highly structured results<a href="#the-workload-should-produce-highly-structured-results" class="hash-link" aria-label="Direct link to The workload should produce highly structured results" title="Direct link to The workload should produce highly structured results">​</a></h4><ul><li><p>[Option 1]<!-- -->: Output the results in JSON-format.</p><ul><li>JSON-formatted results are very easy to parse thus making them very easy to integrate. </li><li>There is a lot of support for JSON in most native and managed programming languages.</li><li>This is the preferred option.<br><br></li></ul></li><li><p>[Option 2]<!-- -->: Output the results in XML-format.</p><ul><li>XML-formatted results are easy to parse thus making them easy to integrate.</li><li>There is a lot of support for XML in most native and managed programming languages.<br><br></li></ul></li><li><p>[Option 3]<!-- -->: Output the results in CSV(comma-separated value)-format.</p><ul><li>CSV-formatted results are easy to parse thus making them easy to integrate.</li><li>There is a lot of support for CSV in most native and managed programming languages.<br><br></li></ul></li><li><p>[Option 4]<!-- -->: Output the results as fixed-width column format.</p><ul><li>Fixed-width column results are fairly common and relatively easy to parse.</li><li>It is best if the results columns are a consistent fixed-width across the board.<br><br></li></ul></li><li><p>[Option 5]<!-- -->: Use system performance counter subsystems.</p><ul><li>Performance counters provide high-precision measurements of system performance and are easy to create on most OS systems.</li><li>The use of performance counters removes the need to write out any specific results.</li><li>The Virtual Client has good native support for capturing performance counters at high-precision.<br><br></li></ul></li><li><p>Ideally, results should be provided in standard/console output or returned in a structured object (e.g. PowerShell script scenarios).</p><br><br></li><li><p>It is also ok to write results to a file, but standard/console output is preferred.</p></li></ul></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-workload-should-handle-any-setup-or-dependency-installation-requirements-where-possible">The workload should handle any setup or dependency installation requirements where possible<a href="#the-workload-should-handle-any-setup-or-dependency-installation-requirements-where-possible" class="hash-link" aria-label="Direct link to The workload should handle any setup or dependency installation requirements where possible" title="Direct link to The workload should handle any setup or dependency installation requirements where possible">​</a></h4><p>There is a balance to strike here. For cases where the setup of dependencies can be handled by the workload itself, they should be. The workload
developer is the expert in the requirements. For certain workloads in the Virtual Client, the dependencies are packaged along with the workload itself.
This is perfectly reasonable and often times ideal to ensure exact dependencies are used with the workload. For scenarios where dependencies cannot
be easily packaged, have a conversation with the CRC team. There are common dependency download and installation scenarios that are better integrated into
the platform than the workload because other workloads share the same/similar requirement.</p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-workload-should-be-provided-as-a-versioned-package">The workload should be provided as a versioned package<a href="#the-workload-should-be-provided-as-a-versioned-package" class="hash-link" aria-label="Direct link to The workload should be provided as a versioned package" title="Direct link to The workload should be provided as a versioned package">​</a></h4><p>In order to support solid ongoing development and servicing practices, workload applications should be versioned. Additionally, the different
versions of the workload should be provided via a package store.</p><ul><li><p>[Option 1]<!-- -->: Provide the workload as a NuGet package</p><ul><li>NuGet packages are very easy to integrate into development environments and build pipelines.</li><li>NuGet packages are easy to integrate into Virtual Client runtime scenarios.</li><li>NuGet packages are easy to create.</li><li>Azure DevOps provides easy ability to create new/custom NuGet feeds for internal package sharing.</li><li>This is the preferred option.<br><br></li></ul></li><li><p>[Option 2]<!-- -->: Provide the workload as an Azure Blob package</p><ul><li>Azure Blob store packages are easy to integrate into Virtual Client runtime scenarios.</li><li>Azure Blob storage accounts are easy to create.</li><li>Even though the package will be stored in Azure Blob, the structure of the package should still
follow NuGet schema recommendations.</li></ul></li></ul><br><p>See <a href="/VirtualClient/docs/developing/0040-vc-packages/">VC Packages</a> for a more detailed description of how packages are
expected to be defined for integration with the Virtual Client.</p></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/microsoft/VirtualClient/edit/main/website/docs/developing/0060-develop-workload.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/VirtualClient/docs/developing/0050-develop-profiling-monitor/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Profiler Integration</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/VirtualClient/docs/developing/0061-build-docker-container/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Building Docker Containers</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#terminology" class="table-of-contents__link toc-highlight">Terminology</a></li><li><a href="#goals-for-creating-a-good-workload" class="table-of-contents__link toc-highlight">Goals for Creating a Good Workload</a></li><li><a href="#workload-recipe" class="table-of-contents__link toc-highlight">Workload Recipe</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/VirtualClient/docs/overview/">Overview</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/microsoft/VirtualClient/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussion<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/VirtualClient/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/microsoft/VirtualClient" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://microsoft.com/" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/VirtualClient/img/microsoft-logo-white-text.svg" alt="MSFT Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/VirtualClient/img/microsoft-logo-white-text.svg" alt="MSFT Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Copyright © 2023 Microsoft.</div></div></div></footer></div>
<script src="/VirtualClient/assets/js/runtime~main.ae9c38a3.js"></script>
<script src="/VirtualClient/assets/js/main.0a41c4c4.js"></script>
</body>
</html>